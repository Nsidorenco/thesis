% \documentclass[twoside,11pt,openright]{report}
\documentclass[ twoside,openright,titlepage,numbers=noenddot,headinclude,%1headlines,% letterpaper a4paper
                footinclude=true,cleardoublepage=empty,abstractoff, % <--- obsolete, remove (todo)
                BCOR=5mm,paper=a4,fontsize=11pt,%11pt,a4paper,%
                ngerman,british,%
                ]{scrreprt}
\PassOptionsToPackage{eulerchapternumbers,listings,
                      pdfspacing,%floatperchapter,
                      % linedheaders,%
                      subfig,beramono
                      % ,eulermath
                    }{classicthesis}
\usepackage{classicthesis}

\usepackage[left=1.7in,right=1.2in,top=1in,bottom=1in]{geometry}% \setlength{\marginparwidth}{1em}%

\usepackage{textcomp} % fix warning with missing font shapes
\usepackage{scrhack} % fix warnings when using KOMA with listings package
\usepackage{xspace} % to get the spacing after macros right
\usepackage{mparhack} % get marginpar right
\usepackage{fixltx2e} % fixes some LaTeX stuff --> since 2015 in the LaTeX kernel (see below)

\usepackage[latin1]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[american]{babel}
% \usepackage{a4}
\usepackage{latexsym}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{mathtools}
\usepackage{epsfig}
\usepackage{mathptmx}
\usepackage{color}
\usepackage{epstopdf}
% \usepackage{microtype}
\usepackage{hyperref}
\usepackage{ragged2e}
\usepackage[square,numbers,sort&compress]{natbib}
\usepackage[useregional]{datetime2}
\DTMlangsetup[en-US]{showdayofmonth=false}
% \usepackage{lipsum}
% \usepackage{listings}
\usepackage{tikz}
\usetikzlibrary{matrix,backgrounds}
\usepackage{lstautogobble}
\usepackage{subcaption}

\usepackage{amsthm}                                % Theorem package
\theoremstyle{definition}                          % plain, definition, remark
\renewcommand*{\proofname}{Proof}


\renewcommand*\sfdefault{lmss}
\renewcommand*\ttdefault{txtt}
\newcommand{\easycrypt}{\texttt{EasyCrypt}}
\newcommand{\validviews}[1]{\textbf{Valid}$(#1)$}
\newcommand{\indis}[1]{{=}\!\{#1\}}
\newenvironment{draft}{\color{red}}{\ignorespacesafterend}

\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{conjecture}[theorem]{Conjecture}

\newcommand{\ie}{i.\,e.}
\newcommand{\Ie}{I.\,e.}
\newcommand{\eg}{e.\,g.}
\newcommand{\Eg}{E.\,g.}

\newcommand{\todo}[1]{{\color[rgb]{.5,0,0}\textbf{$\blacktriangleright$#1$\blacktriangleleft$}}}

\newcommand{\decomp}{\mathcal{D}}
\newcommand{\view}{\textbf{w}}
\newcommand{\tape}{\textbf{k}}
\DeclarePairedDelimiter{\Prfences}{[}{]}
\renewcommand{\Pr}{\operatorname{Pr}\Prfences}

\definecolor{mygreen}{rgb}{0,0.6,0}
\definecolor{mygray}{rgb}{0.5,0.5,0.5}
\definecolor{mymauve}{rgb}{0.58,0,0.82}
\definecolor{aublue}{HTML}{193b77}

\lstset{
  morecomment=[s]{(*}{*)},
  morecomment=[n]{(*}{*)},
  keywordstyle=\color{RoyalBlue},%\bfseries,
  basicstyle=\small\ttfamily,
  commentstyle=\color{Green}\ttfamily,
  stringstyle=\rmfamily,
  numbers=none,%left,%
  numberstyle=\scriptsize,%\tiny
  stepnumber=5,
  numbersep=8pt,
  showstringspaces=false,
  breaklines=true,
  %frameround=ftff,
  belowcaptionskip=.75\baselineskip,
  %frame=L
  backgroundcolor=\color{white},   % choose the background color; you must add \usepackage{color} or \usepackage{xcolor}; should come as last argument
  breakatwhitespace=false,         % sets if automatic breaks should only happen at whitespace
  captionpos=b,                    % sets the caption-position to bottom
  deletekeywords={...},            % if you want to delete keywords from the given language
  escapeinside={\%*}{*)},          % if you want to add LaTeX within your code
  extendedchars=true,              % lets you use non-ASCII characters; for 8-bits encodings only, does not work with UTF-8
  % firstnumber=1000,                % start line enumeration with line 1000
  frame=single,	                   % adds a frame around the code
  keepspaces=true,                 % keeps spaces in text, useful for keeping indentation of code (possibly needs columns=flexible)
  % language=Octave,                 % the language of the code
  morekeywords={*,module,type,proc,Pr,equiv,hoare,lemma,forall, phoare,
    res,op,with,let,in,require,const,var,return,pred,None,Some,clone,export,as,realize,by,split},            % if you want to add more keywords to the set
  rulecolor=\color{black},         % if not set, the frame-color may be changed on line-breaks within not-black text (e.g. comments (green here))
  showspaces=false,                % show spaces everywhere adding particular underscores; it overrides 'showstringspaces'
  showtabs=false,                  % show tabs within strings adding particular underscores
  tabsize=2,	                   % sets default tabsize to 2 spaces
  % title=\lstname                   % show the filename of files included with
  % \lstinputlisting; also try caption instead of title
}
\newcommand{\myTitle}{Formalising Sigma-Protocols and Commitment Schemes in EasyCrypt\xspace}
\newcommand{\mySubtitle}{A Guide for Content \& Style\xspace}
\newcommand{\myDegree}{Master's Thesis\xspace}
\newcommand{\myName}{Nikolaj Sidorenco\xspace}
\newcommand{\myStudentId}{201504729\xspace}
\newcommand{\myProf}{Bas Spitters\xspace}
\newcommand{\myOtherProf}{Sabine Oechsner\xspace}
\newcommand{\myFaculty}{Natural Sciences\xspace}
\newcommand{\myDepartment}{Department of Computer Science\xspace}
\newcommand{\myUni}{Aarhus University\xspace}
\newcommand{\myLocation}{Aarhus\xspace}
\newcommand{\myTime}{\monthname\ \the\year\xspace}


\begin{document}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%*******************************************************
\pagestyle{empty}
\pagenumbering{roman}
\vspace*{\fill}\noindent{\color{aublue}\rule{\linewidth}{1mm}\\[4ex]\color{black}
  \begin{RaggedRight}
\Large \spacedallcaps \myTitle\\ \vspace*{1.5em}
% \large \spacedallcaps \mySubtitle\\ \vspace*{3em}
\end{RaggedRight}
{\noindent\Large \spacedlowsmallcaps \myName, \myStudentId }\\[1ex]
\noindent\color{aublue}\rule{\linewidth}{1mm}\\[4ex]\color{black}
\noindent{\large \spacedlowsmallcaps \myDegree\\[1ex]
June \the\year  \\[1ex] Advisor: \myProf\\[1ex] Co-advisor: \myOtherProf \\[23ex]}\\[\fill]}
\includegraphics[width=\linewidth]{logo}\clearpage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\pagestyle{plain}
\chapter*{Abstract}
\addcontentsline{toc}{chapter}{Abstract}
When applying cryptographic protocols in real-line applications it is paramount
that we can trust them to work as specified. However, many cryptographic proofs
are based on informal reasoning and implicit knowledge. Moreover, many
cryptographic proofs have become so complex, that they are considered
unverifiable.

Advances in formal reasoning of cryptographic protocols has provided a methodology
for constructing more rigours proofs which can eliminate informal reasoning.
Moreover, formal reasoning allow us to construct machine-verifiable proofs.

In this thesis we use the EasyCrypt proof assistant to formally reason about two
cryptographic primitives; Commitment Schemes and $\Sigma$-Protocols.
First, we consider Commitment Schemes, which allows a
Committer to bind himself to a chosen message. The Committer can then later
reveal the message to a Verifier, which can be ensured that the Committer
revealed the same message as the one the bound himself to.
Next, we consider $\Sigma$-Protocols, which allows a Prover to convince a
Verifier, that he knows some secret $x$, without ever revealing the secret to
the Verifier. Additionally, we also consider compound $\Sigma$-Protocol, which
allow us to combine $\Sigma$-Protocols.
To formalise these two primitives we reproduce the results of previous
formalisations to develop abstract specification, which can be used to
instantiate secure concrete protocols. We show the workability by instantiating
Pedersen Commitment Schemes and Schnorr's $\Sigma$-Protocol.

Using the formalisations of $\Sigma$-Protocols and Commitment schemes we
formalise the ZKBoo protocol, which is a generalised $\Sigma$-Protocol, based on Multi-Part
Computations, for proven knowledge for the pre-image of any group homomorphism.
In formalising ZKBoo we successfully formalised arithmetic circuits and an MPC
protocol on arithmetic circuits called the (2,3)-Decomposition.
We then use our abstract specification to prove ZKBoo to be a secure $\Sigma$-Protocol.
With this work we show the discrepancy between the security proofs in
cryptographic papers compared to the reasoning requires to prove a protocol
secure in the formal context.

A highlight of our formalisation, is the security proofs of ZKBoo. Here we show how to
formally prove a complex cryptographic protocol, which depend on the abstract
specifications of $\Sigma$-Protocols, Commitment Schemes, and Multi-Part Computations.

\chapter*{Resum\'e}
\addcontentsline{toc}{chapter}{Resum\'e}

\todo{in Danish\dots}

\chapter*{Acknowledgments}
\addcontentsline{toc}{chapter}{Acknowledgments}

\todo{\dots}

\vspace{2ex}
\begin{flushright}
  \emph{Nikolaj Sidorenco,}\\
  \emph{Aarhus, \today.}
\end{flushright}

\tableofcontents
\cleardoublepage
\pagenumbering{arabic}
\setcounter{secnumdepth}{2}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\input{sections/introduction.tex}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\input{sections/easycrypt.tex}

\input{sections/background.tex}

\input{sections/formal_commitment.tex}

\input{sections/formal_sigma.tex}

\input{sections/general_zk.tex}

\input{sections/formal_zkboo.tex}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\input{sections/conclusion.tex}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\cleardoublepage
\addcontentsline{toc}{chapter}{Bibliography}
\bibliographystyle{plainnat}
\bibliography{refs}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\cleardoublepage
\appendix
% \input{sections/appendix.tex}

\end{document}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "main"
%%% End:
